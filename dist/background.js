(()=>{"use strict";var e={63:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCustomProcedures=function(e){return[new o.default(e),new s.default(e),new u.default(e),new i.default(e),new a.default(e)]};const o=n(r(126)),i=n(r(956)),s=n(r(123)),u=n(r(357)),a=n(r(726))},123:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.browserService=e}getDescription(){return"Merge Windows"}getName(){return"windows.merge"}handle(e){return r(this,void 0,void 0,(function*(){var t,r;return((null===(r=null===(t=e.data)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.pressedKeys)||[]).includes("Enter")&&(yield this.mergeWindows(yield this.browserService.getAllWindowIds())),{sections:[]}}))}mergeWindows(e){return r(this,void 0,void 0,(function*(){let t=[];for(const r of e){const e=yield this.browserService.getTabsFromWindow(r);t=[...t,...e]}return this.browserService.createWindow(t.map((e=>e.id)))}))}}},126:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(r(949));class s{constructor(e){this.browserService=e}getDescription(){return"Extract Tabs By Domain"}getName(){return"tabs.extractByDomain"}handle(e){return n(this,void 0,void 0,(function*(){var t,r,n;const o=e.data,u=(null===(r=null===(t=e.data)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.pressedKeys)||[],a=(null===(n=i.default.getInput(s.INPUT_DOMAIN_ID,o))||void 0===n?void 0:n.value)||"",c=yield this.browserService.getTabsFromCurrentWindow(),d=new Set(c.map((({url:e})=>i.default.getDomainFromURL(e))));return u.includes("Enter")?(yield this.extractTabsByDomain(a),o):{sections:[{elements:[{input:{id:s.INPUT_DOMAIN_ID,placeholder:"Enter domain",value:a}}]},{elements:Array.from(d).sort(((e,t)=>e.localeCompare(t))).filter((e=>0===a.length||e.startsWith(a))).map((e=>({text:{text:e}})))}]}}))}extractTabsByDomain(e){return n(this,void 0,void 0,(function*(){if(e.length>0){const t=(yield this.browserService.getTabsFromCurrentWindow()).filter((({url:t})=>i.default.getDomainFromURL(t).startsWith(e)));yield this.browserService.createWindow(t.map((({id:e})=>e)))}}))}}s.INPUT_DOMAIN_ID="input-domain",t.default=s},209:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{getName(){return"getProcedures"}handle(e){return r(this,arguments,void 0,(function*({context:e}){const{customProcedures:t}=e;return Array.from(t.values()).map((e=>({procedure:e.getName(),description:e.getDescription()})))}))}}},278:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.internalProcedures=new Map,this.customProcedures=new Map;const{internalProcedures:t,customProcedures:r}=e;t.forEach((e=>this.registerInternalProcedure(e))),r.forEach((e=>this.registerCurstomProcedure(e)))}start(){chrome.runtime.onMessage.addListener(((e,t,r)=>{if(e.procedure.startsWith("internal.")){const t=this.internalProcedures.get(e.procedure);t&&t.handle({request:e,context:this.getContext()}).then((e=>r(e)))}else if(e.procedure.startsWith("custom.")){const t=this.customProcedures.get(e.procedure);t&&t.handle(e).then((e=>r(e)))}return!0}))}registerCurstomProcedure(e){this.customProcedures.set(`custom.${e.getName()}`,e)}registerInternalProcedure(e){this.internalProcedures.set(`internal.${e.getName()}`,e)}getContext(){return{customProcedures:this.customProcedures}}}},357:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.browserService=e}getDescription(){return"Sort Tabs By Domain"}getName(){return"tabs.sortByDomain"}handle(e){return r(this,void 0,void 0,(function*(){var t,r;return((null===(r=null===(t=e.data)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.pressedKeys)||[]).includes("Enter")&&(yield this.sortTabsByDomain()),{sections:[]}}))}sortTabsByDomain(){return r(this,void 0,void 0,(function*(){const e=yield this.browserService.getCurrentWindowId(),t=(yield this.browserService.getTabsFromCurrentWindow()).sort(((e,t)=>e.url.localeCompare(t.url)));let r=0;for(const n of t)yield this.browserService.moveTab(n.id,e,r++)}))}}},726:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.browserService=e}getDescription(){return"Ungroup Tabs"}getName(){return"tabs.ungroup"}handle(e){return r(this,void 0,void 0,(function*(){var t,r;return((null===(r=null===(t=e.data)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.pressedKeys)||[]).includes("Enter")&&(yield this.ungroupTabs()),{sections:[]}}))}ungroupTabs(){return r(this,void 0,void 0,(function*(){const e=yield this.browserService.getTabsFromCurrentWindow();for(const t of e)yield this.browserService.ungroupTab(t.id)}))}}},762:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(63),i=n(r(278)),s=n(r(915)),u=n(r(209)),a=new s.default;new class{constructor(e){this.chromeMessageHandler=e}start(){this.chromeMessageHandler.start()}}(new i.default({internalProcedures:[new u.default],customProcedures:(0,o.getCustomProcedures)(a)})).start()},915:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{getAllWindowIds(){return r(this,void 0,void 0,(function*(){return chrome.windows.getAll().then((e=>e.map((e=>e.id||0))))}))}getTabsFromCurrentWindow(){return r(this,void 0,void 0,(function*(){return chrome.tabs.query({currentWindow:!0}).then((e=>e.map((e=>({id:e.id||0,url:e.url||"",index:e.index})))))}))}getCurrentWindowId(){return r(this,void 0,void 0,(function*(){return chrome.windows.getCurrent().then((({id:e})=>e||0))}))}createTabGroup(e,t){return r(this,void 0,void 0,(function*(){const r=yield chrome.tabs.group({tabIds:t});yield chrome.tabGroups.update(r,{title:e,collapsed:!0})}))}getTabsFromWindow(e){return r(this,void 0,void 0,(function*(){return chrome.tabs.query({windowId:e}).then((e=>e.map((e=>({id:e.id||0,url:e.url||"",index:e.index})))))}))}moveTab(e,t,n){return r(this,void 0,void 0,(function*(){yield chrome.tabs.move(e,{windowId:t,index:n})}))}createWindow(e){return r(this,void 0,void 0,(function*(){const[t,...r]=e,n=yield chrome.windows.create({tabId:t,focused:!0});let o=1;for(const e of r)yield this.moveTab(e,n.id||0,o++)}))}ungroupTab(e){return r(this,void 0,void 0,(function*(){yield chrome.tabs.ungroup(e)}))}}},949:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.getDomainFromURL=function(e){let t=new URL(e).hostname;return t.startsWith("www.")&&(t=t.slice(4)),t},e.getInput=function(e,{sections:t}){for(const{elements:r}of t)for(const t of r)if(t.input&&t.input.id===e)return t.input;return null}}(r||(r={})),t.default=r},956:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(r(949));t.default=class{constructor(e){this.browserService=e}getDescription(){return"Group Tabs By Domain"}getName(){return"tabs.groupByDomain"}handle(e){return n(this,void 0,void 0,(function*(){var t,r;return((null===(r=null===(t=e.data)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.pressedKeys)||[]).includes("Enter")&&(yield this.groupTabsByDomain()),{sections:[]}}))}groupTabsByDomain(){return n(this,void 0,void 0,(function*(){var e;const t=yield this.browserService.getTabsFromCurrentWindow(),r=new Map;for(const n of t){const t=i.default.getDomainFromURL(n.url);r.has(t)||r.set(t,[]),null===(e=r.get(t))||void 0===e||e.push(n)}for(const[e,t]of r.entries()){const r=e.includes(".")?e.split(".").slice(0,-1).join("."):e;yield this.browserService.createTabGroup(r,t.map((({id:e})=>e)))}}))}}}},t={};!function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(762)})();